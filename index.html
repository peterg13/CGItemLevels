<!DOCTYPE html>
<html lang="en">
<head>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

	<link rel="stylesheet" href="./assets/css/Main.css">
</head>
<body>
	<!--Table of Item Levels-->
	<section>
	  <div class="tbl-header">
	    <table cellpadding="0" cellspacing="0" border="0">
	      <thead>
	        <tr>
	          <th>Name</th>
	          <th>Item Level</th>
	        </tr>
	      </thead>
	    </table>
	  </div>
	  <div class="tbl-content">
	    <table cellpadding="0" cellspacing="0" border="0" id='ilvlTable'>
	      <tbody>
	        <!--This is where new entries go-->
	      </tbody>
	    </table>
	  </div>
	</section>



	<div id="addAndRemove">
		<div id="addCharacterContainer">
		  <h1>Add Character</h1>
		  <form>
		    <input type="text" name="charName" placeholder="Character" id="charName">
		    <input type="text" name="charRealm" placeholder="Realm" id="charRealm">
		    <a id="submitButton">Add</a>
		    </form>
		</div>

		<div id="removeCharacterContainer">
		  <h1>Remove Character</h1>
		  <form>
		    <input type="text" name="charName" placeholder="Character" id="charNameToRemove">
		    <a id="removeButton">Remove</a>
		    </form>
		</div>

		<a id="updateButton"> update </a>
	</div>

	<div id="alliancePic">
	</div>


	
	<script>
	$("#removeButton").on("click",function(){
		var name = document.getElementById("charNameToRemove").value;
		document.getElementById("charNameToRemove").value = '';
		//this loop finds the row in the table and removes it from the page
		for(i = 0; i < document.getElementById("ilvlTable").rows.length; i++){
			var currentRowName = document.getElementById("ilvlTable").rows[i].cells[0].innerHTML;
			if(currentRowName == name){
				document.getElementById("ilvlTable").deleteRow(i);
			}
		}
		//This send the remove request to server
		$.ajax({
			url: '/removeCharacter',
			method: 'POST',
			data: {name: name},
			dataType: 'json',
		}).done(function(response){
			console.log(response);
		});
	
	})
	</script>
	<script>
	$("#submitButton").on("click",function(){
		var name = document.getElementById("charName").value;
		var realm = document.getElementById("charRealm").value;
		document.getElementById("charName").value = '';
		document.getElementById("charRealm").value = '';
		//adds an empty character to the end of the table
		var table = document.getElementById("ilvlTable");
		var tableSize = document.getElementById("ilvlTable").rows.length;
		var row = table.insertRow(tableSize);
		var cell = row.insertCell(0);
		cell.innerHTML = name;
		//sends the new character request to server
		$.ajax({
			url: '/newCharacter',
			method: 'POST',
			data: {name: name, realm: realm},
			dataType: 'json',
		}).done(function(response){
			console.log(response);
		});
	
	})
	</script>
	<script>
	$("#updateButton").on("click",function(){
		$.ajax({
			url: '/update',
			method: 'GET',
		}).done(function(response){
			console.log(response);
		});
	})
	</script>
	<script>$( document ).ready(function() {
    $.ajax({
			url: '/pullTable',
			method: 'GET',
		}).done(function(response){
			//$("body").append("<b>" + response.name + response.realm + response.ilvl + "</b>");
			console.log(response);
			for(i = 0; i < response.length; i++){
				$("#ilvlTable tbody").append("<tr id='class-" + response[i].class + "'><td>" + response[i].name + '</td><td>' + response[i].ilvl + "</td></tr>");
			}
		});
});</script>

	
</html>